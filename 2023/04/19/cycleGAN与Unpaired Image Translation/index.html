<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>cycleGAN与Unpaired Image Translation | Hexo</title><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="论文链接：Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks cycleGAN的提出之前提到的GAN实现通用图像间转换 ——Pix2Pix详解中pix2pix实现了通用的Image to Image Translation模型 然而pix2pix的训练需要成对的图像数据集很多时候我们无法获得">
<meta property="og:type" content="article">
<meta property="og:title" content="cycleGAN与Unpaired Image Translation">
<meta property="og:url" content="https://niiickz.github.io/2023/04/19/cycleGAN%E4%B8%8EUnpaired%20Image%20Translation/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="论文链接：Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks cycleGAN的提出之前提到的GAN实现通用图像间转换 ——Pix2Pix详解中pix2pix实现了通用的Image to Image Translation模型 然而pix2pix的训练需要成对的图像数据集很多时候我们无法获得">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2023-04-19T13:17:06.000Z">
<meta property="article:modified_time" content="2023-12-02T13:41:34.183Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="LLM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://niiickz.github.io/2023/04/19/cycleGAN%E4%B8%8EUnpaired%20Image%20Translation/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'cycleGAN与Unpaired Image Translation',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-02 21:41:34'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Hexo"><span class="site-name">Hexo</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">cycleGAN与Unpaired Image Translation</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-04-19T13:17:06.000Z" title="Created 2023-04-19 21:17:06">2023-04-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-12-02T13:41:34.183Z" title="Updated 2023-12-02 21:41:34">2023-12-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="cycleGAN与Unpaired Image Translation"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>论文链接：<a target="_blank" rel="noopener" href="https://openaccess.thecvf.com/content_ICCV_2017/papers/Zhu_Unpaired_Image-To-Image_Translation_ICCV_2017_paper.pdf">Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks</a></p>
<h2 id="cycleGAN的提出"><a href="#cycleGAN的提出" class="headerlink" title="cycleGAN的提出"></a>cycleGAN的提出</h2><p>之前提到的<a target="_blank" rel="noopener" href="https://renns.top/post/16/">GAN实现通用图像间转换 ——Pix2Pix详解</a>中<br>pix2pix实现了通用的Image to Image Translation模型</p>
<p>然而pix2pix的训练<strong>需要成对的图像数据集</strong><br>很多时候我们无法获得这样的数据集，例如如图的转换</p>
<p><img src="D:\code\cloud\blog\img\unpaired_image.png" alt="unpaired_image"></p>
<p>针对这种问题，作者基于pix2pix的结构，提出了cycleGAN</p>
<h2 id="cycleGAN的理论"><a href="#cycleGAN的理论" class="headerlink" title="cycleGAN的理论"></a>cycleGAN的理论</h2><p><img src="D:\code\cloud\blog\img\cycleGAN.png" alt="cycleGAN"></p>
<p>图(a)表示cycleGAN的对抗训练部分</p>
<p>cycleGAN含有<strong>两个生成器和两个判别器</strong><br>两个生成器分别学习映射$G:X\rightarrow Y$和$F: Y\rightarrow X$，其中X与Y分别表示两个不成对的图像分布<br>两个判别器则是分别判断生成的两个假图像分布$\hat{X},\hat{Y}$​真实性的</p>
<h3 id="cycle-consistence-loss"><a href="#cycle-consistence-loss" class="headerlink" title="cycle consistence loss"></a>cycle consistence loss</h3><p>首先给出部分论文原文</p>
<blockquote>
<p>Adversarial training can, in theory, learn mappings G and F that produce outputs identically distributed as target domains Y and X respectively (strictly speaking, this requires G and F to be stochastic functions). </p>
<p>However, with large enough capacity, a network can map the same set of input images to any random permutation of images in the target domain, where any of the learned mappings can induce an output distribution that matches the target distribution. Thus, adversarial losses alone cannot guarantee that the learned function can map an individual input xi to yi.</p>
</blockquote>
<p>即如果只使用对抗训练，在网络容量和数据量足够大的情况下<br>网络可以将同一分布映射到目标分布的不同排列上<br>此时对于单个输入x，我们并不一定能获得想要的输出y</p>
<p>因此作者引入了cycle consistence loss（循环一致性损失）</p>
<p>上图中(b)(c)即表示cycleGAN进行cycle consistence训练的过程<br>即$\forall x\in X$​训练目标为$x\rightarrow G(x) \rightarrow F(G(x))\approx x$​，反之$\forall y\in Y$​同理</p>
<p>这部分的损失函数使用了L1损失，如下所示<br>（论文中作者尝试将L1替换成对抗损失，但没有明显的效果提升）</p>
<p><script type="math/tex">L_{\mathrm{cyc}}(G,F)=E_{x\sim p_{\mathrm{data}}(x)}[\|F(G(x))-x\|_1]+E_{y\sim p_{\mathrm{data}}(y)}[\|G(F(y))-y\|_1]</script>​</p>
<p>cycleGAN的最终损失函数为</p>
<p><script type="math/tex">L(G,F,D_X,D_Y)=L_{\mathrm{GAN}}(G,D_Y,X,Y)+L_{\mathrm{GAN}}(F,D_X,Y,X)+\lambda L_{\mathrm{cyc}}(G,F)</script>​</p>
<p>论文中取$\lambda=10$​，且<strong>对抗训练采用least square loss</strong>而不是对数损失</p>
<p>生成器的训练目标为</p>
<p><script type="math/tex">G^{*},F^{*}=\arg \underset{G,F}{\min}\underset{D_X,D_Y}{\max}L(G,F,D_X,D_Y)</script>​</p>
<h3 id="identity-loss"><a href="#identity-loss" class="headerlink" title="identity loss"></a>identity loss</h3><p>上述损失已经是cycleGAN针对大部分问题的损失了<br>但是对于art to photo和photo enhancement问题作者还引入了<strong>identity loss</strong></p>
<p><script type="math/tex">L_{\mathrm{identity}}(G,F)=E_{x\sim p_{\mathrm{data}}(x)}[\|F(x)-x\|_1]+E_{y\sim p_{\mathrm{data}}(y)}[\|G(y)-y\|_1]</script>​</p>
<p>这个损失以$0.5\lambda$的权重加入原损失</p>
<p>加入identity loss的因为是原损失可能出现如图的问题<br>即虽然达到了风格转换的目的，但也改变了一些不应该改变的输入信息</p>
<p><img src="D:\code\cloud\blog\img\cycleGAN_identity.png" alt="cycleGAN_identity"></p>
<h2 id="Keras代码实现"><a href="#Keras代码实现" class="headerlink" title="Keras代码实现"></a>Keras代码实现</h2><p>生成器和判别器结构依照论文附录构建</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Model</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dropout, Conv2D, LeakyReLU, Input, Add, Activation, Conv2DTranspose</span><br><span class="line"><span class="keyword">from</span> keras.optimizers <span class="keyword">import</span> Adam</span><br><span class="line"><span class="keyword">from</span> keras.initializers <span class="keyword">import</span> RandomNormal</span><br><span class="line"><span class="keyword">from</span> NormalizationLayer <span class="keyword">import</span> InstanceNormalization</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataLoader</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, dir_A, dir_B, batch_size, img_shape</span>):</span><br><span class="line">        self.dir_A = dir_A</span><br><span class="line">        self.dir_B = dir_B</span><br><span class="line"></span><br><span class="line">        self.flist = os.listdir(dir_A)</span><br><span class="line">        self.fnum = <span class="built_in">len</span>(self.flist)</span><br><span class="line"></span><br><span class="line">        self.batch_size = batch_size</span><br><span class="line">        self.img_shape = img_shape</span><br><span class="line"></span><br><span class="line">        self.idx_cur = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getNumberOfBatch</span>(<span class="params">self</span>):</span><br><span class="line">        num = self.fnum / self.batch_size</span><br><span class="line">        <span class="keyword">if</span> self.fnum % self.batch_size != <span class="number">0</span>:</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(num)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reset</span>(<span class="params">self</span>):</span><br><span class="line">        self.idx_cur = <span class="number">0</span></span><br><span class="line">        random.shuffle(self.flist)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.idx_cur &gt;= self.fnum:</span><br><span class="line">            self.reset()</span><br><span class="line">            <span class="keyword">raise</span> StopIteration</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.idx_cur+self.batch_size-<span class="number">1</span> &lt; self.fnum:</span><br><span class="line">            length = self.batch_size</span><br><span class="line">            idx_nxt = self.idx_cur+self.batch_size</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            length = self.fnum-self.idx_cur</span><br><span class="line">            idx_nxt = self.fnum</span><br><span class="line"></span><br><span class="line">        imgA = np.zeros((length, *self.img_shape))</span><br><span class="line">        imgB = np.zeros((length, *self.img_shape))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">            fpath_A = os.path.join(self.dir_A, self.flist[self.idx_cur+k])</span><br><span class="line">            fpath_B = os.path.join(self.dir_B, self.flist[self.idx_cur+k])</span><br><span class="line"></span><br><span class="line">            img_a = cv2.imread(fpath_A, <span class="number">1</span>)</span><br><span class="line">            img_b = cv2.imread(fpath_B, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            imgA[k] = (img_a.astype(np.float32) - <span class="number">127.5</span>) / <span class="number">127.5</span></span><br><span class="line">            imgB[k] = (img_b.astype(np.float32) - <span class="number">127.5</span>) / <span class="number">127.5</span></span><br><span class="line"></span><br><span class="line">        self.idx_cur = idx_nxt</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> imgA, imgB</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CycleGAN</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, L_id=<span class="literal">False</span></span>):</span><br><span class="line">        self.img_row = <span class="number">256</span></span><br><span class="line">        self.img_col = <span class="number">256</span></span><br><span class="line">        self.img_channels = <span class="number">3</span></span><br><span class="line">        self.img_shape = (self.img_row, self.img_col, self.img_channels)</span><br><span class="line"></span><br><span class="line">        patch = <span class="built_in">int</span>(self.img_row / <span class="number">2</span> ** <span class="number">4</span>)</span><br><span class="line">        self.discPatch = (patch, patch, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.L_id = L_id</span><br><span class="line">        self.buildGAN(L_id)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">buildGenerator</span>(<span class="params">self, num_resNet</span>):</span><br><span class="line">        initWeight = RandomNormal(stddev=<span class="number">0.02</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">resBlock</span>(<span class="params">inputs, filters</span>):</span><br><span class="line">            x = Conv2D(filters, kernel_size=<span class="number">3</span>, padding=<span class="string">&#x27;same&#x27;</span>, kernel_initializer=initWeight)(inputs)</span><br><span class="line">            x = InstanceNormalization()(x)</span><br><span class="line">            x = Activation(<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line"></span><br><span class="line">            x = Conv2D(filters, kernel_size=<span class="number">3</span>, padding=<span class="string">&#x27;same&#x27;</span>, kernel_initializer=initWeight)(x)</span><br><span class="line">            x = InstanceNormalization()(x)</span><br><span class="line">            x = Activation(<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line"></span><br><span class="line">            x = Add()([x, inputs])</span><br><span class="line">            outputs = Activation(<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">            <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">convLayer</span>(<span class="params">inputs, filters, k_size=<span class="number">3</span>, stride=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span></span>):</span><br><span class="line">            x = Conv2D(filters, kernel_size=k_size, strides=stride, padding=<span class="string">&#x27;same&#x27;</span>, kernel_initializer=initWeight)(inputs)</span><br><span class="line">            x = InstanceNormalization()(x)</span><br><span class="line">            outputs = Activation(act)(x)</span><br><span class="line">            <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">deConvLayer</span>(<span class="params">inputs, filters, k_size=<span class="number">3</span>, stride=<span class="number">2</span></span>):</span><br><span class="line">            x = Conv2DTranspose(filters, kernel_size=k_size, strides=stride, padding=<span class="string">&#x27;same&#x27;</span>, kernel_initializer=initWeight)(inputs)</span><br><span class="line">            x = InstanceNormalization()(x)</span><br><span class="line">            outputs = Activation(<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">            <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line">        img_input = Input(shape=self.img_shape)</span><br><span class="line"></span><br><span class="line">        x = convLayer(img_input, <span class="number">64</span>, k_size=<span class="number">7</span>)</span><br><span class="line">        x = convLayer(x, <span class="number">128</span>, stride=<span class="number">2</span>)</span><br><span class="line">        x = convLayer(x, <span class="number">256</span>, stride=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_resNet):</span><br><span class="line">            x = resBlock(x, <span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">        x = deConvLayer(x, <span class="number">128</span>)</span><br><span class="line">        x = deConvLayer(x, <span class="number">64</span>)</span><br><span class="line">        img_output = convLayer(x, <span class="number">3</span>, k_size=<span class="number">7</span>, act=<span class="string">&#x27;tanh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Model(img_input, img_output)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">buildDiscriminator</span>(<span class="params">self</span>):</span><br><span class="line">        initWeight = RandomNormal(stddev=<span class="number">0.02</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">discLayer</span>(<span class="params">inputs, filters, k_size=<span class="number">4</span>, norm=<span class="literal">True</span></span>):</span><br><span class="line">            x = Conv2D(filters, kernel_size=k_size, strides=<span class="number">2</span>, padding=<span class="string">&#x27;same&#x27;</span>, kernel_initializer=initWeight)(inputs)</span><br><span class="line">            <span class="keyword">if</span> norm:</span><br><span class="line">                x = InstanceNormalization()(x)</span><br><span class="line">            outputs = LeakyReLU(alpha=<span class="number">0.2</span>)(x)</span><br><span class="line">            <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line">        inputImg = Input(shape=self.img_shape)</span><br><span class="line"></span><br><span class="line">        disc1 = discLayer(inputImg, <span class="number">64</span>, norm=<span class="literal">False</span>)</span><br><span class="line">        disc2 = discLayer(disc1, <span class="number">128</span>)</span><br><span class="line">        disc3 = discLayer(disc2, <span class="number">256</span>)</span><br><span class="line">        disc4 = discLayer(disc3, <span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">        validity = Conv2D(filters=<span class="number">1</span>, kernel_size=<span class="number">4</span>, padding=<span class="string">&#x27;same&#x27;</span>, kernel_initializer=initWeight)(disc4)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Model(inputImg, validity)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">buildGAN</span>(<span class="params">self, L_id=<span class="literal">False</span></span>):</span><br><span class="line">        lambda_cycle = <span class="number">10.0</span></span><br><span class="line">        lambda_id = <span class="number">0.5</span> * lambda_cycle <span class="comment"># used for arts -&gt; photo</span></span><br><span class="line">        optimizer = Adam(<span class="number">2e-4</span>, <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># build discriminator</span></span><br><span class="line">        self.disc_A = self.buildDiscriminator()</span><br><span class="line">        self.disc_B = self.buildDiscriminator()</span><br><span class="line"></span><br><span class="line">        self.disc_A.<span class="built_in">compile</span>(loss=<span class="string">&#x27;mse&#x27;</span>, optimizer=optimizer, metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line">        self.disc_B.<span class="built_in">compile</span>(loss=<span class="string">&#x27;mse&#x27;</span>, optimizer=optimizer, metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># build generator, 6 ResBlock for 128x128, 9 for 256x256</span></span><br><span class="line">        self.gen_AB = self.buildGenerator(num_resNet=<span class="number">9</span>)</span><br><span class="line">        self.gen_BA = self.buildGenerator(num_resNet=<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">        imgA = Input(shape=self.img_shape)</span><br><span class="line">        imgB = Input(shape=self.img_shape)</span><br><span class="line"></span><br><span class="line">        fake_B = self.gen_AB(imgA)</span><br><span class="line">        fake_A = self.gen_BA(imgB)</span><br><span class="line"></span><br><span class="line">        reconstr_A = self.gen_BA(fake_B)</span><br><span class="line">        reconstr_B = self.gen_AB(fake_A)</span><br><span class="line"></span><br><span class="line">        self.disc_A.trainable = <span class="literal">False</span></span><br><span class="line">        self.disc_B.trainable = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        valid_A = self.disc_A(fake_A)</span><br><span class="line">        valid_B = self.disc_B(fake_B)</span><br><span class="line"></span><br><span class="line">        outputs = [valid_A, valid_B, reconstr_A, reconstr_B]</span><br><span class="line">        loss = [<span class="string">&#x27;mse&#x27;</span>, <span class="string">&#x27;mse&#x27;</span>, <span class="string">&#x27;mae&#x27;</span>, <span class="string">&#x27;mae&#x27;</span>]</span><br><span class="line">        loss_weights = [<span class="number">1</span>, <span class="number">1</span>, lambda_cycle, lambda_cycle]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> L_id:</span><br><span class="line">            imgA_id = self.gen_BA(imgA)</span><br><span class="line">            imgB_id = self.gen_AB(imgB)</span><br><span class="line"></span><br><span class="line">            outputs.append(imgA_id)</span><br><span class="line">            loss.append(<span class="string">&#x27;mae&#x27;</span>)</span><br><span class="line">            loss_weights.append(lambda_id)</span><br><span class="line"></span><br><span class="line">            outputs.append(imgB_id)</span><br><span class="line">            loss.append(<span class="string">&#x27;mae&#x27;</span>)</span><br><span class="line">            loss_weights.append(lambda_id)</span><br><span class="line"></span><br><span class="line">        self.combined = Model(inputs=[imgA, imgB], outputs=outputs)</span><br><span class="line">        self.combined.<span class="built_in">compile</span>(optimizer=optimizer, loss=loss, loss_weights=loss_weights)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">trainModel</span>(<span class="params">self, epochs, batch_size=<span class="number">1</span></span>):</span><br><span class="line">        self.dataLoader = DataLoader(</span><br><span class="line">            <span class="string">&#x27;F:/wallpaper/datas/test/trainA&#x27;</span>, <span class="string">&#x27;F:/wallpaper/datas/test/trainB&#x27;</span>,</span><br><span class="line">            batch_size, self.img_shape</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        totalStep = self.dataLoader.getNumberOfBatch()</span><br><span class="line">        <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">            <span class="keyword">for</span> step, (imgA, imgB) <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.dataLoader):</span><br><span class="line">                valid = np.ones((imgA.shape[<span class="number">0</span>],) + self.discPatch)</span><br><span class="line">                fake = np.zeros((imgA.shape[<span class="number">0</span>],) + self.discPatch)</span><br><span class="line"></span><br><span class="line">                fake_B = self.gen_AB.predict(imgA)</span><br><span class="line">                fake_A = self.gen_BA.predict(imgB)</span><br><span class="line"></span><br><span class="line">                discA_loss_real = self.disc_A.train_on_batch(imgA, valid)</span><br><span class="line">                discA_loss_fake = self.disc_A.train_on_batch(fake_A, fake)</span><br><span class="line">                D_A_loss = <span class="number">0.5</span> * np.add(discA_loss_real, discA_loss_fake)</span><br><span class="line"></span><br><span class="line">                discB_loss_real = self.disc_B.train_on_batch(imgB, valid)</span><br><span class="line">                discB_loss_fake = self.disc_B.train_on_batch(fake_B, fake)</span><br><span class="line">                D_B_loss = <span class="number">0.5</span> * np.add(discB_loss_real, discB_loss_fake)</span><br><span class="line"></span><br><span class="line">                D_loss = <span class="number">0.5</span> * np.add(D_A_loss, D_B_loss)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> self.L_id:</span><br><span class="line">                    G_loss = self.combined.train_on_batch([imgA, imgB], [valid, valid, imgA, imgB, imgA, imgB])</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Epoch &#123;&#125;/&#123;&#125; : Batch &#123;&#125;/&#123;&#125; -- D loss: &#123;:.6f&#125;, acc: &#123;:.2f&#125; , &quot;</span></span><br><span class="line">                          <span class="string">&quot;G loss: &#123;:.6f&#125;, adv:&#123;:.6f&#125;, recon: &#123;:.6f&#125;, id: &#123;:.6f&#125;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">                        epoch+<span class="number">1</span>, epochs, step+<span class="number">1</span>, totalStep, D_loss[<span class="number">0</span>], D_loss[<span class="number">1</span>] * <span class="number">100</span>,</span><br><span class="line">                                G_loss[<span class="number">0</span>], np.mean(G_loss[<span class="number">1</span>:<span class="number">3</span>]), np.mean(G_loss[<span class="number">3</span>:<span class="number">5</span>]), np.mean(G_loss[<span class="number">5</span>:<span class="number">6</span>])</span><br><span class="line">                    ))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    G_loss = self.combined.train_on_batch([imgA, imgB], [valid, valid, imgA, imgB])</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Epoch &#123;&#125;/&#123;&#125; : Batch &#123;&#125;/&#123;&#125; -- D loss: &#123;:.6f&#125;, acc: &#123;:.2f&#125; , &quot;</span></span><br><span class="line">                          <span class="string">&quot;G loss: &#123;:.6f&#125;, adv:&#123;:.6f&#125;, recon: &#123;:.6f&#125;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">                        epoch+<span class="number">1</span>, epochs, step+<span class="number">1</span>, totalStep, D_loss[<span class="number">0</span>], D_loss[<span class="number">1</span>] * <span class="number">100</span>,</span><br><span class="line">                        G_loss[<span class="number">0</span>], np.mean(G_loss[<span class="number">1</span>:<span class="number">3</span>]), np.mean(G_loss[<span class="number">3</span>:<span class="number">5</span>])</span><br><span class="line">                    ))</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> step % <span class="number">200</span> == <span class="number">0</span>:</span><br><span class="line">                    fpath = <span class="string">&#x27;F:/wallpaper/datas/sketch/testB/1047028.png&#x27;</span></span><br><span class="line">                    fname = <span class="string">&#x27;output&#123;&#125;.png&#x27;</span>.<span class="built_in">format</span>(epoch)</span><br><span class="line">                    self.colorizeImage(fpath=fpath, outputDir=<span class="string">&#x27;output&#x27;</span>, fname=fname)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">colorizeImage</span>(<span class="params">self, fpath, outputDir, fname</span>):</span><br><span class="line">        img_input = cv2.imread(fpath, <span class="number">1</span>)</span><br><span class="line">        img_input = cv2.resize(img_input, (<span class="number">256</span>, <span class="number">256</span>))</span><br><span class="line"></span><br><span class="line">        img_input = np.expand_dims(img_input, <span class="number">0</span>)</span><br><span class="line">        img_input = (img_input.astype(np.float32) - <span class="number">127.5</span>) / <span class="number">127.5</span></span><br><span class="line"></span><br><span class="line">        img_output = self.gen_AB.predict(img_input)[<span class="number">0</span>]</span><br><span class="line">        img_output = img_output * <span class="number">127.5</span> + <span class="number">127.5</span></span><br><span class="line">        img_output = img_output.astype(np.uint8)</span><br><span class="line"></span><br><span class="line">        outputPath = os.path.join(outputDir, fname)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(outputDir):</span><br><span class="line">            os.mkdir(outputDir)</span><br><span class="line">        cv2.imwrite(outputPath, img_output)</span><br><span class="line"></span><br><span class="line">model = CycleGAN()</span><br><span class="line">model.trainModel(epochs=<span class="number">5</span>, batch_size=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://niiickZ.github.io">John Doe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://niiickz.github.io/2023/04/19/cycleGAN%E4%B8%8EUnpaired%20Image%20Translation/">https://niiickz.github.io/2023/04/19/cycleGAN%E4%B8%8EUnpaired%20Image%20Translation/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/LLM/">LLM</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/04/19/infoGAN%E4%B8%8Edisentangled%20representation%E5%AD%A6%E4%B9%A0/" title="infoGAN与disentangled representation学习"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">infoGAN与disentangled representation学习</div></div></a></div><div class="next-post pull-right"><a href="/2023/04/19/LSGAN%E8%AF%A6%E8%A7%A3/" title="LSGAN详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">LSGAN详解</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/08/01/A%20Review%20of%20Recent%20Multimodal%20ERC%20model/" title="A Review of Recent Multimodal ERC model"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="title">A Review of Recent Multimodal ERC model</div></div></a></div><div><a href="/2023/08/03/A%20Simple%20Review%20of%20Spatial-based%20ConvGNN/" title="A Simple Review of Spatial-based ConvGNN"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-03</div><div class="title">A Simple Review of Spatial-based ConvGNN</div></div></a></div><div><a href="/2023/03/10/Auto-Encoding%20Variational%20Bayes%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/" title="Auto-Encoding Variational Bayes论文解读"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-10</div><div class="title">Auto-Encoding Variational Bayes论文解读</div></div></a></div><div><a href="/2023/09/12/A%20Simple%20Review%20of%20Pre-training%20Models%20for%20Dialogue%20System/" title="A Simple Review of Pre-training Models for Dialogue System"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-12</div><div class="title">A Simple Review of Pre-training Models for Dialogue System</div></div></a></div><div><a href="/2023/09/26/ALBEF%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/" title="ALBEF论文解读"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-26</div><div class="title">ALBEF论文解读</div></div></a></div><div><a href="/2023/09/24/BLIP-2%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/" title="BLIP-2论文解读"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-24</div><div class="title">BLIP-2论文解读</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">John Doe</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#cycleGAN%E7%9A%84%E6%8F%90%E5%87%BA"><span class="toc-number">1.</span> <span class="toc-text">cycleGAN的提出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cycleGAN%E7%9A%84%E7%90%86%E8%AE%BA"><span class="toc-number">2.</span> <span class="toc-text">cycleGAN的理论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cycle-consistence-loss"><span class="toc-number">2.1.</span> <span class="toc-text">cycle consistence loss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#identity-loss"><span class="toc-number">2.2.</span> <span class="toc-text">identity loss</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Keras%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">Keras代码实现</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/10/05/IMAGEBIND%20and%20PandaGPT%E7%AE%80%E4%BB%8B/" title="IMAGEBIND and PandaGPT简介">IMAGEBIND and PandaGPT简介</a><time datetime="2023-10-05T08:15:47.000Z" title="Created 2023-10-05 16:15:47">2023-10-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/09/30/Flamingo%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/" title="Flamingo论文解读">Flamingo论文解读</a><time datetime="2023-09-30T12:31:31.000Z" title="Created 2023-09-30 20:31:31">2023-09-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/09/29/OSCAR%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/" title="OSCAR论文解读">OSCAR论文解读</a><time datetime="2023-09-29T09:32:34.000Z" title="Created 2023-09-29 17:32:34">2023-09-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/09/28/FlAN%E7%B3%BB%E5%88%97%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/" title="FlAN系列论文解读">FlAN系列论文解读</a><time datetime="2023-09-28T08:43:46.000Z" title="Created 2023-09-28 16:43:46">2023-09-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/09/27/NExT-GPT%20Any-to-Any%20Multimodal%20LLM/" title="NExT-GPT Any-to-Any Multimodal LLM">NExT-GPT Any-to-Any Multimodal LLM</a><time datetime="2023-09-27T02:22:53.000Z" title="Created 2023-09-27 10:22:53">2023-09-27</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By John Doe</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>